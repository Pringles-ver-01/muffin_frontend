{"ast":null,"code":"import t from \"lodash.debounce\";\nimport n, { useRef as r, useState as e, useEffect as o } from \"react\";\nimport { select as a, event as i } from \"d3-selection\";\nimport s from \"resize-observer-polyfill\";\nimport \"d3-transition\";\nimport { range as u, min as l, max as f, descending as c } from \"d3-array\";\nimport d from \"d3-cloud\";\nimport h from \"lodash.clonedeep\";\nimport m from \"seedrandom\";\nimport p from \"tippy.js\";\nimport { dispatch as y } from \"d3-dispatch\";\nimport { scaleOrdinal as x, scaleLinear as v, scaleSqrt as g, scaleLog as b } from \"d3-scale\";\nimport { schemeCategory10 as w } from \"d3-scale-chromatic\";\nimport \"tippy.js/dist/tippy.css\";\nimport \"tippy.js/animations/scale.css\";\n\nfunction M() {\n  return (M = Object.assign || function (t) {\n    for (var n = 1; n < arguments.length; n++) {\n      var r = arguments[n];\n\n      for (var e in r) {\n        Object.prototype.hasOwnProperty.call(r, e) && (t[e] = r[e]);\n      }\n    }\n\n    return t;\n  }).apply(this, arguments);\n}\n\nvar z = Math.PI / 180;\n\nfunction k(t) {\n  return t.text;\n}\n\nfunction W() {\n  return \"serif\";\n}\n\nfunction S() {\n  return \"normal\";\n}\n\nfunction O(t) {\n  return Math.sqrt(t.value);\n}\n\nfunction T() {\n  return 30 * (~~(6 * Math.random()) - 3);\n}\n\nfunction j() {\n  return 1;\n}\n\nfunction A(t, n, r, e) {\n  if (!n.sprite) {\n    var o = t.context,\n        a = t.ratio;\n    o.clearRect(0, 0, 2048 / a, 2048 / a);\n    var i = 0,\n        s = 0,\n        u = 0,\n        l = r.length;\n\n    for (--e; ++e < l;) {\n      n = r[e], o.save(), o.font = n.style + \" \" + n.weight + \" \" + ~~((n.size + 1) / a) + \"px \" + n.font;\n      var f = o.measureText(n.text + \"m\").width * a,\n          c = n.size << 1;\n\n      if (n.rotate) {\n        var d = Math.sin(n.rotate * z),\n            h = Math.cos(n.rotate * z),\n            m = f * h,\n            p = f * d,\n            y = c * h,\n            x = c * d;\n        f = Math.max(Math.abs(m + x), Math.abs(m - x)) + 31 >> 5 << 5, c = ~~Math.max(Math.abs(p + y), Math.abs(p - y));\n      } else f = f + 31 >> 5 << 5;\n\n      if (c > u && (u = c), i + f >= 2048 && (i = 0, s += u, u = 0), s + c >= 2048) break;\n      o.translate((i + (f >> 1)) / a, (s + (c >> 1)) / a), n.rotate && o.rotate(n.rotate * z), o.fillText(n.text, 0, 0), n.padding && (o.lineWidth = 2 * n.padding, o.strokeText(n.text, 0, 0)), o.restore(), n.width = f, n.height = c, n.xoff = i, n.yoff = s, n.x1 = f >> 1, n.y1 = c >> 1, n.x0 = -n.x1, n.y0 = -n.y1, n.hasText = !0, i += f;\n    }\n\n    for (var v = o.getImageData(0, 0, 2048 / a, 2048 / a).data, g = []; --e >= 0;) {\n      if ((n = r[e]).hasText) {\n        for (var b = (f = n.width) >> 5, w = (c = n.y1 - n.y0, 0); w < c * b; w++) {\n          g[w] = 0;\n        }\n\n        if (null == (i = n.xoff)) return;\n        s = n.yoff;\n\n        for (var M = 0, k = -1, W = 0; W < c; W++) {\n          for (w = 0; w < f; w++) {\n            var S = v[2048 * (s + W) + (i + w) << 2] ? 1 << 31 - w % 32 : 0;\n            g[b * W + (w >> 5)] |= S, M |= S;\n          }\n\n          M ? k = W : (n.y0++, c--, W--, s++);\n        }\n\n        n.y1 = n.y0 + k, n.sprite = g.slice(0, (n.y1 - n.y0) * b);\n      }\n    }\n  }\n}\n\nfunction I(t, n, r) {\n  for (var e, o = t.sprite, a = t.width >> 5, i = t.x - (a << 4), s = 127 & i, u = 32 - s, l = t.y1 - t.y0, f = (t.y + t.y0) * (r >>= 5) + (i >> 5), c = 0; c < l; c++) {\n    e = 0;\n\n    for (var d = 0; d <= a; d++) {\n      if ((e << u | (d < a ? (e = o[c * a + d]) >>> s : 0)) & n[f + d]) return !0;\n    }\n\n    f += r;\n  }\n\n  return !1;\n}\n\nfunction q(t, n) {\n  var r = t[0],\n      e = t[1];\n  n.x + n.x0 < r.x && (r.x = n.x + n.x0), n.y + n.y0 < r.y && (r.y = n.y + n.y0), n.x + n.x1 > e.x && (e.x = n.x + n.x1), n.y + n.y1 > e.y && (e.y = n.y + n.y1);\n}\n\nfunction E(t) {\n  var n = t[0] / t[1];\n  return function (t) {\n    return [n * (t *= .1) * Math.cos(t), t * Math.sin(t)];\n  };\n}\n\nfunction C() {\n  return document.createElement(\"canvas\");\n}\n\nfunction D(t) {\n  return \"function\" == typeof t ? t : function () {\n    return t;\n  };\n}\n\nvar F = {\n  archimedean: E,\n  rectangular: function rectangular(t) {\n    var n = 4 * t[0] / t[1],\n        r = 0,\n        e = 0;\n    return function (t) {\n      var o = t < 0 ? -1 : 1;\n\n      switch (Math.sqrt(1 + 4 * o * t) - o & 3) {\n        case 0:\n          r += n;\n          break;\n\n        case 1:\n          e += 4;\n          break;\n\n        case 2:\n          r -= n;\n          break;\n\n        default:\n          e -= 4;\n      }\n\n      return [r, e];\n    };\n  }\n};\n\nfunction P(t, n) {\n  return t[Math.floor(n() * t.length)];\n}\n\nfunction L(t) {\n  return t.size + \"px\";\n}\n\nfunction N(t) {\n  return t.text;\n}\n\nfunction R(t) {\n  return \"translate(\" + t.x + \", \" + t.y + \")\" + (\"number\" == typeof t.rotate ? \"rotate(\" + t.rotate + \")\" : \"\");\n}\n\nfunction U(t) {\n  var n,\n      r = t.callbacks,\n      e = t.maxWords,\n      o = t.options,\n      a = t.selection,\n      s = t.size,\n      u = o.deterministic,\n      x = o.enableOptimizations,\n      w = o.fontFamily,\n      z = o.fontStyle,\n      U = o.fontSizes,\n      H = o.fontWeight,\n      B = o.padding,\n      G = o.randomSeed,\n      J = o.rotations,\n      K = o.rotationAngles,\n      Q = o.spiral,\n      V = o.scale,\n      X = t.words.concat().sort(function (t, n) {\n    return c(t.value, n.value);\n  }).slice(0, e),\n      Y = m(u ? G || \"deterministic\" : null);\n  (n = x ? function () {\n    var t = [256, 256],\n        n = k,\n        r = W,\n        e = O,\n        o = S,\n        a = S,\n        i = T,\n        s = j,\n        u = E,\n        l = [],\n        f = Infinity,\n        c = y(\"word\", \"end\"),\n        d = Math.random,\n        h = {},\n        m = C,\n        p = !1;\n\n    function x(n, r, e) {\n      for (var o, a, i, s, l, f = r.x, c = r.y, h = Math.sqrt(t[0] * t[0] + t[1] * t[1]), m = u(t), p = d() < .5 ? 1 : -1, y = -p; (o = m(y += p)) && (a = ~~o[0], i = ~~o[1], !(Math.min(Math.abs(a), Math.abs(i)) >= h));) {\n        if (r.x = f + a, r.y = c + i, !(r.x + r.x0 < 0 || r.y + r.y0 < 0 || r.x + r.x1 > t[0] || r.y + r.y1 > t[1] || e && I(r, n, t[0]) || e && !((s = r).x + s.x1 > (l = e)[0].x && s.x + s.x0 < l[1].x && s.y + s.y1 > l[0].y && s.y + s.y0 < l[1].y))) {\n          for (var x, v = r.sprite, g = r.width >> 5, b = t[0] >> 5, w = r.x - (g << 4), M = 127 & w, z = 32 - M, k = r.y1 - r.y0, W = (r.y + r.y0) * b + (w >> 5), S = 0; S < k; S++) {\n            x = 0;\n\n            for (var O = 0; O <= g; O++) {\n              n[W + O] |= x << z | (O < g ? (x = v[S * g + O]) >>> M : 0);\n            }\n\n            W += b;\n          }\n\n          return delete r.sprite, !0;\n        }\n      }\n\n      return !1;\n    }\n\n    return h.canvas = function (t) {\n      return arguments.length ? (m = D(t), h) : m;\n    }, h.start = function () {\n      var u = function (t) {\n        t.width = t.height = 1;\n        var n = Math.sqrt(t.getContext(\"2d\").getImageData(0, 0, 1, 1).data.length >> 2);\n        t.width = 2048 / n, t.height = 2048 / n;\n        var r = t.getContext(\"2d\");\n        return r.fillStyle = r.strokeStyle = \"red\", r.textAlign = \"center\", {\n          context: r,\n          ratio: n\n        };\n      }(m()),\n          f = new Uint32Array((t[0] >> 5) * t[1]),\n          y = null,\n          v = [],\n          g = l.map(function (t, u) {\n        return t.text = n.call(this, t, u), t.font = r.call(this, t, u), t.style = o.call(this, t, u), t.weight = a.call(this, t, u), t.rotate = i.call(this, t, u), t.size = ~~e.call(this, t, u), t.padding = s.call(this, t, u), t;\n      }).sort(function (t, n) {\n        return n.size - t.size;\n      });\n\n      return setTimeout(function () {\n        return function n(r) {\n          var e = 50 * r,\n              o = Math.min(50 * (r + 1), l.length);\n          !function (n, r) {\n            for (var e = n; e < r; e += 1) {\n              var o = g[e];\n              o.x = t[0] * (d() + .5) >> 1, o.y = t[1] * (d() + .5) >> 1, A(u, o, g, e), o.hasText && x(f, o, y) && (v.push(o), c.call(\"word\", h, o), y ? q(y, o) : y = [{\n                x: o.x + o.x0,\n                y: o.y + o.y0\n              }, {\n                x: o.x + o.x1,\n                y: o.y + o.y1\n              }], o.x -= t[0] >> 1, o.y -= t[1] >> 1);\n            }\n          }(e, o), p || (o < l.length ? setTimeout(function () {\n            return n(r + 1);\n          }, 0) : (h.stop(), c.call(\"end\", h, v, y)));\n        }(0);\n      }, 0), h;\n    }, h.revive = function () {\n      return p = !1, h;\n    }, h.stop = function () {\n      return p = !0, h;\n    }, h.timeInterval = function (t) {\n      return arguments.length ? (f = null == t ? Infinity : t, h) : f;\n    }, h.words = function (t) {\n      return arguments.length ? (l = t, h) : l;\n    }, h.size = function (n) {\n      return arguments.length ? (t = [+n[0], +n[1]], h) : t;\n    }, h.font = function (t) {\n      return arguments.length ? (r = D(t), h) : r;\n    }, h.fontStyle = function (t) {\n      return arguments.length ? (o = D(t), h) : o;\n    }, h.fontWeight = function (t) {\n      return arguments.length ? (a = D(t), h) : a;\n    }, h.rotate = function (t) {\n      return arguments.length ? (i = D(t), h) : i;\n    }, h.text = function (t) {\n      return arguments.length ? (n = D(t), h) : n;\n    }, h.spiral = function (t) {\n      return arguments.length ? (u = F[t] || t, h) : u;\n    }, h.fontSize = function (t) {\n      return arguments.length ? (e = D(t), h) : e;\n    }, h.padding = function (t) {\n      return arguments.length ? (s = D(t), h) : s;\n    }, h.random = function (t) {\n      return arguments.length ? (d = t, h) : d;\n    }, h.on = function () {\n      var t = c.on.apply(c, arguments);\n      return t === c ? h : t;\n    }, h;\n  }() : d()).size(s).padding(B).words(h(X)).rotate(function () {\n    return void 0 === J ? 30 * (~~(6 * Y()) - 3) : function (t, n, r) {\n      if (t < 1) return 0;\n      var e = [];\n      if (1 === t) e = [n[0]];else {\n        e = [].concat(n);\n\n        for (var o = (n[1] - n[0]) / (t - 1), a = n[0] + o; a < n[1];) {\n          e.push(a), a += o;\n        }\n      }\n      return P(e, r);\n    }(J, K, Y);\n  }).spiral(Q).random(Y).text(N).font(w).fontStyle(z).fontWeight(H), function t(e, s) {\n    void 0 === s && (s = 1), x && n.revive(), n.fontSize(function (t) {\n      return function (t, n, r) {\n        var e,\n            o = l(t, function (t) {\n          return Number(t.value);\n        }),\n            a = f(t, function (t) {\n          return Number(t.value);\n        });\n\n        switch (r) {\n          case \"log\":\n            e = b;\n            break;\n\n          case \"sqrt\":\n            e = g;\n            break;\n\n          case \"linear\":\n          default:\n            e = v;\n        }\n\n        return e().domain([o, a]).range(n);\n      }(X, e, V)(t.value);\n    }).on(\"end\", function (n) {\n      if (X.length !== n.length && s <= 10) {\n        10 === s && console.warn(\"Unable to layout \" + (X.length - n.length) + \" word(s) after \" + s + \" attempts.  Consider: (1) Increasing the container/component size. (2) Lowering the max font size. (3) Limiting the rotation angles.\");\n        var u = Math.max(.95 * e[0], 1);\n        t([u, Math.max(.95 * e[1], u)], s + 1);\n      } else !function (t) {\n        var n,\n            r = t.callbacks,\n            e = t.options,\n            o = t.random,\n            a = t.words,\n            s = r.getWordColor,\n            u = r.getWordTooltip,\n            l = r.onWordClick,\n            f = r.onWordMouseOver,\n            c = r.onWordMouseOut,\n            d = e.colors,\n            h = e.enableTooltip,\n            m = e.fontStyle,\n            y = e.fontWeight,\n            x = e.textAttributes,\n            v = e.tooltipOptions,\n            g = e.fontFamily,\n            b = e.transitionDuration;\n\n        function w(t) {\n          return s ? s(t) : P(d, o);\n        }\n\n        t.selection.selectAll(\"text\").data(a).join(function (t) {\n          var r = t.append(\"text\").on(\"click\", function (t) {\n            l && l(t, i);\n          }).on(\"mouseover\", function (t) {\n            h && (n = p(i.target, M({\n              animation: \"scale\",\n              arrow: !0,\n              content: function content() {\n                return u(t);\n              }\n            }, v))), f && f(t, i);\n          }).on(\"mouseout\", function (t) {\n            n && n.destroy(), c && c(t, i);\n          }).attr(\"cursor\", l ? \"pointer\" : \"default\").attr(\"fill\", w).attr(\"font-family\", g).attr(\"font-style\", m).attr(\"font-weight\", y).attr(\"text-anchor\", \"middle\").attr(\"transform\", \"translate(0, 0) rotate(0)\");\n          \"object\" == typeof x && Object.keys(x).forEach(function (t) {\n            r = r.attr(t, x[t]);\n          }), r = r.call(function (t) {\n            return t.transition().duration(b).attr(\"font-size\", L).attr(\"transform\", R).text(N);\n          });\n        }, function (t) {\n          t.transition().duration(b).attr(\"fill\", w).attr(\"font-family\", g).attr(\"font-size\", L).attr(\"transform\", R).text(N);\n        }, function (t) {\n          t.transition().duration(b).attr(\"fill-opacity\", 0).remove();\n        });\n      }({\n        callbacks: r,\n        options: o,\n        random: Y,\n        selection: a,\n        words: n\n      });\n    }).start();\n  }(U);\n}\n\nvar H = {\n  getWordTooltip: function getWordTooltip(t) {\n    return t.text + \" (\" + t.value + \")\";\n  }\n},\n    B = {\n  colors: u(20).map(function (t) {\n    return t.toString();\n  }).map(x(w)),\n  deterministic: !1,\n  enableOptimizations: !1,\n  enableTooltip: !0,\n  fontFamily: \"times new roman\",\n  fontSizes: [4, 32],\n  fontStyle: \"normal\",\n  fontWeight: \"normal\",\n  padding: 1,\n  rotationAngles: [-90, 90],\n  scale: \"sqrt\",\n  spiral: \"rectangular\",\n  tooltipOptions: {},\n  transitionDuration: 600\n};\n\nfunction G(i) {\n  var u = i.callbacks,\n      l = i.maxWords,\n      f = void 0 === l ? 100 : l,\n      c = i.minSize,\n      d = i.options,\n      h = i.size,\n      m = i.words,\n      p = function (t, n) {\n    if (null == t) return {};\n    var r,\n        e,\n        o = {},\n        a = Object.keys(t);\n\n    for (e = 0; e < a.length; e++) {\n      n.indexOf(r = a[e]) >= 0 || (o[r] = t[r]);\n    }\n\n    return o;\n  }(i, [\"callbacks\", \"maxWords\", \"minSize\", \"options\", \"size\", \"words\"]),\n      y = M({}, H, u),\n      x = M({}, B, d),\n      v = function (t, n, i) {\n    var u = r(),\n        l = e(n),\n        f = l[0],\n        c = l[1],\n        d = e(null),\n        h = d[0],\n        m = d[1];\n    return o(function () {\n      var r = u.current,\n          e = a(r).append(\"svg\").style(\"display\", \"block\");\n      \"object\" == typeof i && Object.keys(i).forEach(function (t) {\n        e = e.attr(t, i[t]);\n      });\n      var o = e.append(\"g\");\n\n      function l(t, n) {\n        e.attr(\"height\", n).attr(\"width\", t), o.attr(\"transform\", \"translate(\" + t / 2 + \", \" + n / 2 + \")\"), c([t, n]);\n      }\n\n      m(o);\n      var f = 0,\n          d = 0;\n      void 0 === n ? (f = r.parentElement.offsetWidth, d = r.parentElement.offsetHeight) : (f = n[0], d = n[1]), l(f = Math.max(f, t[0]), d = Math.max(d, t[1]));\n      var h = new s(function (t) {\n        if (t && 0 !== t.length && void 0 === n) {\n          var r = t[0].contentRect;\n          l(r.width, r.height);\n        }\n      });\n      return h.observe(r), function () {\n        h.unobserve(r), a(r).selectAll(\"*\").remove();\n      };\n    }, [n, t, i]), [u, h, f];\n  }(c, h, d.svgAttributes),\n      g = v[0],\n      b = v[1],\n      w = v[2],\n      z = r(t(U, 100));\n\n  return o(function () {\n    b && z.current({\n      callbacks: y,\n      maxWords: f,\n      options: x,\n      selection: b,\n      size: w,\n      words: m\n    });\n  }, [f, y, x, b, w, m]), n.createElement(\"div\", M({\n    ref: g,\n    style: {\n      height: \"100%\",\n      width: \"100%\"\n    }\n  }, p));\n}\n\nG.defaultProps = {\n  callbacks: H,\n  maxWords: 100,\n  minSize: [300, 300],\n  options: B\n};\nexport default G;\nexport { H as defaultCallbacks, B as defaultOptions };","map":null,"metadata":{},"sourceType":"module"}